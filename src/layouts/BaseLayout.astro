---
import { getRelativeLocaleUrl } from 'astro:i18n';

interface Props {
  title: string;
}

const { title } = Astro.props;
const currentLocale = Astro.currentLocale || 'en';
const locales = ['en', 'fr', 'es'] as const;
const localeNames: Record<string, string> = {
  en: 'English',
  fr: 'Français',
  es: 'Español',
};

// Get the current path without the locale prefix
const currentPath = Astro.url.pathname;
const pathWithoutLocale = currentPath.replace(/^\/(en|fr|es)/, '') || '/';
---

<html lang={currentLocale}>
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>{title} | How To Use Internet</title>
  </head>
  <body>
    <header>
      <nav>
        <a href={getRelativeLocaleUrl(currentLocale, '/')}>How To Use Internet</a>
        <div>
          {locales.map((locale) => (
            locale === currentLocale ? (
              <strong>{localeNames[locale]}</strong>
            ) : (
              <a href={getRelativeLocaleUrl(locale, pathWithoutLocale)}>{localeNames[locale]}</a>
            )
          ))}
        </div>
      </nav>
    </header>
    <main>
      <slot />
    </main>
    <footer>
      <p>&copy; {new Date().getFullYear()} How To Use Internet. Licensed under Apache 2.0.</p>
    </footer>
  </body>
</html>
